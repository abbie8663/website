<!DOCTYPE html>
<html>
<head>
    <title>Contacts</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body >
    <center>
    <img alt="圖片" src="ele.jpg" width="500" height="200" />
    <form>
	<br><br>
    學號：<input type="text" name="uid" id="uid"><br><br> 
	姓名：<input type="text" name="name" id="name"><br><br> 
	電話：<input type="text" name="tel" id="tel"><br><br> 
	信箱：<input type="text" name="address" id="address"><br><br> 


         
    <input type="button" onclick="insert(this.form)" value="新增">  
	<input type="button" onclick="del(this.form)" value="刪除">  
	<input type="button" onclick="edit(this.form)" value="修改">  
 	<input type="button" onclick="show(this.form)" value="列出">  
 	<input type="button" onclick="reset(this.form)" value="重設"> <br><br> 

	搜尋：<input type="text" name="findtext" id="findtext">
	<input type="button" onclick="find(this.form)" value="查詢">  <br><br> 

	通訊錄<br><br>
	<table  id="table" style="border:3px #FFAC55 dashed; padding:10px;" rules="all" cellpadding='10';>
		<tr><td>學號</td><td>姓名</td><td>電話</td><td>信箱</td></tr>
		<!-- //<tr><td>404530035</td><td>蕭陳新</td><td>0988905322</td><td>abbie@gmail.com</td></tr>				 -->
	</table>

    </form></center>

    <!-- <p id="msg"></p> -->
 
    <script>
      
        var contacts = [] 
        function insert(form){  
            let uid = form.uid.value 
            let name = form.name.value
            let tel = form.tel.value
            let address = form.address.value
            let exit=0

            if(!uid||!name||!tel||!address)
                alert("請完整填寫!")
            else{
                for(let i=0;i<contacts.length;i++){
                    if(uid==contacts[i].ID){
                        alert("ID已存在")
                        exit=1
                        break;
                    }
                }
                if(exit!=1){//不存在

                    var object = {
                        'ID': uid,
                        'name': name,
                        'tel': tel,
                        'address': address,
                    }


                    contacts.push(object)
                    // let msg = document.getElementById("msg")
                    // let text = document.createTextNode(object.ID)
                    // msg.appendChild(text)


                    let tr = document.createElement('tr');
                    tr.setAttribute("id", uid);  
                    table.appendChild(tr);
                    let td = tr.insertCell(0);
                    let td2 = tr.insertCell(1);
                    let td3 = tr.insertCell(2);
                    let td4 = tr.insertCell(3);
                    td.setAttribute("id", "id");
                    td2.setAttribute("id", "name");
                    td3.setAttribute("id", "phone");
                    td4.setAttribute("id", "mail");
                    td.innerHTML = uid;
                    td2.innerHTML = name;
                    td3.innerHTML = tel;
                    td4.innerHTML = address;
                }//if
            }//else
        } //insert    
        function del(form){
            let uid = form.uid.value
            let exit=0

            if(!uid)
                alert("請填寫學號!")
            else{
                for(var i=0;i<contacts.length;i++){
                    if(uid==contacts[i].ID){
                        exit=1
                        break;
                    }
                }
                if(exit!=0){//存在
                    let tr = document.getElementById(uid);
                    table.removeChild(tr);
                    contacts.splice(i, 1);
                }else{
                    alert("學號不存在!")
                }
            }
        }//delete 
        function edit(form){
            let uid = form.uid.value 
            let name = form.name.value
            let tel = form.tel.value
            let address = form.address.value
            let exit=0

            if(!uid||!name||!tel||!address)
                alert("請填寫完整內容!")
            else{
                for(var i=0;i<contacts.length;i++){
                    if(uid==contacts[i].ID){
                        exit=1
                        break;
                    }
                }
                if(exit!=0){//存在
                    let tr = document.getElementById(uid);
                    tr.childNodes[1].textContent=name;
                    tr.childNodes[2].textContent=tel;
                    tr.childNodes[3].textContent=address;
                    contacts[i].name=name;
                    contacts[i].tel=tel;
                    contacts[i].address=address;
                }else{
                    alert("學號不存在!")
                }
            }

        }//edit
        function show(form){
            for(let i=0;i<contacts.length;i++){
                let tr = document.getElementById(contacts[i].ID);
                tr.style.display="table-row";
            }   
        }
        function find(form){
            let findtext = form.findtext.value
            let exit=0 
            if(!findtext)
                alert("請填寫!")
            else{
                for(let i=0;i<contacts.length;i++){
                    let tr = document.getElementById(contacts[i].ID)
                    tr.style.display="none"
                }        
                for(let i=0;i<contacts.length;i++){
                    if((contacts[i].ID.match(findtext)!=null)||(contacts[i].name.match(findtext)!=null)||(contacts[i].tel.match(findtext)!=null)||(contacts[i].address.match(findtext)!=null))
                        {
                        exit=1
                        let tr = document.getElementById(contacts[i].ID);
                        tr.style.display="table-row";
                    }
                }
            }
            if(exit==0)//no存在
                    alert("不存在!")
        }//find
    </script>

</body>
</html>